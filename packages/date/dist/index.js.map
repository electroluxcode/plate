{"version":3,"sources":["../src/index.ts","../src/lib/BaseDatePlugin.ts","../src/lib/transforms/insertDate.ts","../src/lib/queries/isPointNextToNode.ts"],"sourcesContent":["/**\n * @file Automatically generated by barrelsby.\n */\n\nexport * from './lib/index';\n","import { bindFirst, createSlatePlugin, KEYS } from 'platejs';\n\nimport { insertDate } from './transforms';\n\nexport const BaseDatePlugin = createSlatePlugin({\n  key: KEYS.date,\n  node: {\n    isElement: true,\n    isInline: true,\n    isSelectable: false,\n    isVoid: true,\n  },\n}).extendEditorTransforms(({ editor }) => ({\n  insert: {\n    date: bindFirst(insertDate, editor),\n  },\n}));\n","import type { InsertNodesOptions, SlateEditor, TDateElement } from 'platejs';\n\nimport { KEYS } from 'platejs';\n\nexport const insertDate = (\n  editor: SlateEditor,\n  { date, ...options }: { date?: string } & InsertNodesOptions = {}\n) => {\n  editor.tf.insertNodes<TDateElement | { text: string }>(\n    [\n      {\n        children: [{ text: '' }],\n        date: date ?? new Date().toDateString(),\n        type: editor.getType(KEYS.date),\n      },\n      // FIXME: for not losing the editor focus\n      {\n        text: ' ',\n      },\n    ],\n    options as any\n  );\n};\n","import { type Path, type Point, type SlateEditor, PathApi } from 'platejs';\n\nexport const isPointNextToNode = (\n  editor: SlateEditor,\n  options: {\n    nodeType: string;\n    at?: Point;\n    reverse?: boolean;\n  }\n): boolean => {\n  // eslint-disable-next-line prefer-const\n  let { at, nodeType, reverse = false } = options;\n\n  if (!at) {\n    at = editor.selection?.anchor;\n  }\n  if (!at) {\n    throw new Error('No valid selection point found');\n  }\n\n  const selectedRange = editor.api.range(at.path)!;\n  const boundary = (() => {\n    let isStart = false;\n    let isEnd = false;\n\n    if (editor.api.isStart(at, selectedRange)) {\n      isStart = true;\n    }\n    if (editor.api.isEnd(at, selectedRange)) {\n      isEnd = true;\n    }\n    if (isStart && isEnd) {\n      return 'single';\n    }\n    if (isStart) {\n      return 'start';\n    }\n    if (isEnd) {\n      return 'end';\n    }\n\n    return null;\n  })();\n\n  if (!boundary) return false;\n\n  const adjacentPathFn = (path: Path) => {\n    try {\n      if (reverse && boundary === 'start') return PathApi.previous(path);\n      if (!reverse && boundary === 'end') return PathApi.next(path);\n      if (boundary === 'single') {\n        return reverse ? PathApi.previous(path) : PathApi.next(path);\n      }\n    } catch {\n      return null;\n    }\n  };\n\n  if (!adjacentPathFn) return false;\n\n  const adjacentPath = adjacentPathFn(at.path);\n\n  if (!adjacentPath) return false;\n\n  const nextNodeEntry = editor.api.node(adjacentPath) ?? null;\n\n  return !!(nextNodeEntry && nextNodeEntry[0].type === nodeType);\n};\n"],"mappings":";;;;;;;;;;;;;;;;;;;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;;;ACAA,IAAAA,kBAAmD;;;ACEnD,qBAAqB;AAEd,IAAM,aAAa,CACxB,QACA,EAAE,MAAM,GAAG,QAAQ,IAA4C,CAAC,MAC7D;AACH,SAAO,GAAG;AAAA,IACR;AAAA,MACE;AAAA,QACE,UAAU,CAAC,EAAE,MAAM,GAAG,CAAC;AAAA,QACvB,MAAM,SAAQ,oBAAI,KAAK,GAAE,aAAa;AAAA,QACtC,MAAM,OAAO,QAAQ,oBAAK,IAAI;AAAA,MAChC;AAAA;AAAA,MAEA;AAAA,QACE,MAAM;AAAA,MACR;AAAA,IACF;AAAA,IACA;AAAA,EACF;AACF;;;ADlBO,IAAM,qBAAiB,mCAAkB;AAAA,EAC9C,KAAK,qBAAK;AAAA,EACV,MAAM;AAAA,IACJ,WAAW;AAAA,IACX,UAAU;AAAA,IACV,cAAc;AAAA,IACd,QAAQ;AAAA,EACV;AACF,CAAC,EAAE,uBAAuB,CAAC,EAAE,OAAO,OAAO;AAAA,EACzC,QAAQ;AAAA,IACN,UAAM,2BAAU,YAAY,MAAM;AAAA,EACpC;AACF,EAAE;;;AEhBF,IAAAC,kBAAiE;AAE1D,IAAM,oBAAoB,CAC/B,QACA,YAKY;AAEZ,MAAI,EAAE,IAAI,UAAU,UAAU,MAAM,IAAI;AAExC,MAAI,CAAC,IAAI;AACP,SAAK,OAAO,WAAW;AAAA,EACzB;AACA,MAAI,CAAC,IAAI;AACP,UAAM,IAAI,MAAM,gCAAgC;AAAA,EAClD;AAEA,QAAM,gBAAgB,OAAO,IAAI,MAAM,GAAG,IAAI;AAC9C,QAAM,YAAY,MAAM;AACtB,QAAI,UAAU;AACd,QAAI,QAAQ;AAEZ,QAAI,OAAO,IAAI,QAAQ,IAAI,aAAa,GAAG;AACzC,gBAAU;AAAA,IACZ;AACA,QAAI,OAAO,IAAI,MAAM,IAAI,aAAa,GAAG;AACvC,cAAQ;AAAA,IACV;AACA,QAAI,WAAW,OAAO;AACpB,aAAO;AAAA,IACT;AACA,QAAI,SAAS;AACX,aAAO;AAAA,IACT;AACA,QAAI,OAAO;AACT,aAAO;AAAA,IACT;AAEA,WAAO;AAAA,EACT,GAAG;AAEH,MAAI,CAAC,SAAU,QAAO;AAEtB,QAAM,iBAAiB,CAAC,SAAe;AACrC,QAAI;AACF,UAAI,WAAW,aAAa,QAAS,QAAO,wBAAQ,SAAS,IAAI;AACjE,UAAI,CAAC,WAAW,aAAa,MAAO,QAAO,wBAAQ,KAAK,IAAI;AAC5D,UAAI,aAAa,UAAU;AACzB,eAAO,UAAU,wBAAQ,SAAS,IAAI,IAAI,wBAAQ,KAAK,IAAI;AAAA,MAC7D;AAAA,IACF,QAAQ;AACN,aAAO;AAAA,IACT;AAAA,EACF;AAEA,MAAI,CAAC,eAAgB,QAAO;AAE5B,QAAM,eAAe,eAAe,GAAG,IAAI;AAE3C,MAAI,CAAC,aAAc,QAAO;AAE1B,QAAM,gBAAgB,OAAO,IAAI,KAAK,YAAY,KAAK;AAEvD,SAAO,CAAC,EAAE,iBAAiB,cAAc,CAAC,EAAE,SAAS;AACvD;","names":["import_platejs","import_platejs"]}